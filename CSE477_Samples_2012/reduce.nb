(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     22387,        526]
NotebookOptionsPosition[     21822,        504]
NotebookOutlinePosition[     22245,        520]
CellTagsIndexPosition[     22202,        517]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
CSE 477 / G. Farin
Degree reduction\
\>", "Subtitle",
 CellChangeTimes->{{3.461330617453125*^9, 3.4613306210625*^9}, {
  3.5365247471447277`*^9, 3.536524750391914*^9}, {3.536524781545696*^9, 
  3.5365247940554113`*^9}}],

Cell["\<\


A Bezier polygon is given in the array b, defining a degree n Bezier curve. \
The process of degree reduction produces an array bred, defining a degree n-1 \
Bezier curve.\
\>", "Text",
 CellChangeTimes->{{3.461365902515625*^9, 3.4613660873125*^9}, {
   3.4930473189393983`*^9, 3.493047345921689*^9}, 3.5238249171203184`*^9, {
   3.524337306745322*^9, 3.5243373259803686`*^9}, {3.52433735886559*^9, 
   3.5243374141995*^9}, {3.5243374524827414`*^9, 3.524337942070095*^9}, {
   3.5243379905717382`*^9, 3.5243379905717382`*^9}, {3.524338070398985*^9, 
   3.5243382348116007`*^9}, {3.5243382921274705`*^9, 3.524338297884018*^9}, {
   3.5243384599481764`*^9, 3.5243384769994135`*^9}, {3.5243385386209936`*^9, 
   3.5243385502900925`*^9}, {3.5365247741862745`*^9, 3.536524776761422*^9}, {
   3.5366109041172485`*^9, 3.5366109863889546`*^9}, 3.5367734423219023`*^9},
 FontFamily->"Arial",
 FontSize->18],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "0"}], "}"}]}], "}"}], ",", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "cubic", " ", "is", " ", "actually", " ", "a", " ", 
       "quadratic"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "i"}], ")"}], "+", 
          RowBox[{"RandomReal", "[", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "although", " ", "this", " ", "looks", " ", "like", " ", "a", " ", 
       "quadratic"}], ",", " ", 
      RowBox[{"it", " ", "is", " ", "a", " ", "true", " ", "cubic"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"bb", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", 
    RowBox[{
     RowBox[{"Length", "[", "b", "]"}], "-", "1"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"current", " ", "degree"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nred", " ", "=", " ", 
    RowBox[{"n", "-", "1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"reduced", " ", "degree"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"elevmat", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"nred", "+", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"nred", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "matrix", " ", "used", " ", "to", " ", "elevate", " ", "from", " ", 
     "degree", " ", "n", " ", "to", " ", "n"}], "+", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"elevmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"elevmat", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"nred", "+", "2"}], ",", 
      RowBox[{"nred", "+", "1"}]}], "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"elevmat", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"nred", "+", "1"}], ")"}]}]}], ";", " ", 
       RowBox[{
        RowBox[{"elevmat", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"1", "-", 
         RowBox[{"elevmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}]}]}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"nred", "+", "1"}]}], "}"}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "building", " ", "elevation", " ", "matrix"}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<elevtion matrix: \>\"", ",", 
      RowBox[{"MatrixForm", "[", "elevmat", "]"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<elev_transpose.elev \>\"", ",", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "elevmat", "]"}], ".", "elevmat"}], "]"}]}],
      "]"}], "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", "b", "]"}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.461330650984375*^9, 3.46133073921875*^9}, {
   3.46133084284375*^9, 3.461331026171875*^9}, {3.4613311473125*^9, 
   3.461331164109375*^9}, {3.461331392265625*^9, 3.461331400625*^9}, {
   3.461331495671875*^9, 3.46133151278125*^9}, {3.461332052140625*^9, 
   3.46133205996875*^9}, {3.461332126625*^9, 3.461332179140625*^9}, {
   3.4613323144375*^9, 3.46133231896875*^9}, {3.461332634765625*^9, 
   3.461332768828125*^9}, {3.4613328201875*^9, 3.461332842125*^9}, {
   3.461332903359375*^9, 3.461332924390625*^9}, {3.4613330685625*^9, 
   3.461333073328125*^9}, {3.46133320725*^9, 3.461333223734375*^9}, {
   3.461333275859375*^9, 3.46133331634375*^9}, {3.461333378546875*^9, 
   3.46133338159375*^9}, {3.461333652953125*^9, 3.461333970109375*^9}, {
   3.461334023671875*^9, 3.46133402953125*^9}, {3.461334218765625*^9, 
   3.461334220046875*^9}, {3.461334267125*^9, 3.46133426771875*^9}, {
   3.461334308640625*^9, 3.461334324015625*^9}, {3.46133450859375*^9, 
   3.461334519078125*^9}, {3.461334588671875*^9, 3.46133471046875*^9}, {
   3.461334899046875*^9, 3.46133492065625*^9}, {3.461334985078125*^9, 
   3.46133502809375*^9}, {3.461335078125*^9, 3.46133513265625*^9}, {
   3.461335182125*^9, 3.46133518284375*^9}, {3.46133551928125*^9, 
   3.461335521578125*^9}, {3.461335568359375*^9, 3.4613355691875*^9}, {
   3.46133567125*^9, 3.461335672484375*^9}, {3.461335710234375*^9, 
   3.461335719515625*^9}, {3.461336866984375*^9, 3.461336962609375*^9}, {
   3.46133701109375*^9, 3.461337012390625*^9}, {3.461337074671875*^9, 
   3.461337075328125*^9}, {3.4613371349375*^9, 3.461337145265625*^9}, {
   3.46133729809375*^9, 3.461337299296875*^9}, {3.4613373346875*^9, 
   3.461337335828125*^9}, {3.461337375953125*^9, 3.461337425828125*^9}, {
   3.46133757234375*^9, 3.461337574546875*^9}, {3.46133760575*^9, 
   3.46133761765625*^9}, {3.461338144265625*^9, 3.461338165578125*^9}, {
   3.4613397745*^9, 3.46133979071875*^9}, 3.461361288390625*^9, {
   3.461361780828125*^9, 3.461361782734375*^9}, {3.461361853359375*^9, 
   3.461361861328125*^9}, {3.461361893796875*^9, 3.46136191984375*^9}, {
   3.46136201015625*^9, 3.461362176953125*^9}, {3.46136221165625*^9, 
   3.461362275328125*^9}, {3.4613623524375*^9, 3.461362402796875*^9}, {
   3.461362470203125*^9, 3.461362471046875*^9}, {3.461362533265625*^9, 
   3.461362576953125*^9}, {3.461362625234375*^9, 3.461362638796875*^9}, {
   3.4613631633125*^9, 3.461363165890625*^9}, {3.461363997453125*^9, 
   3.461364016578125*^9}, {3.46136450871875*^9, 3.461364523578125*^9}, 
   3.461364796515625*^9, {3.461364880296875*^9, 3.461364886015625*^9}, {
   3.461364956671875*^9, 3.461364957890625*^9}, {3.4613655725*^9, 
   3.46136557378125*^9}, 3.46136581790625*^9, 3.4613658745*^9, 
   3.46136611421875*^9, 3.493047055185147*^9, {3.4930474209496746`*^9, 
   3.493047421807603*^9}, {3.493047533379942*^9, 3.4930475537068725`*^9}, {
   3.493047588463895*^9, 3.4930475887134967`*^9}, 3.4930476764172587`*^9, {
   3.523825244299693*^9, 3.523825276264149*^9}, 3.523825435244028*^9, {
   3.523825715670121*^9, 3.523825716278522*^9}, 3.523825787960648*^9, {
   3.5238260718031464`*^9, 3.5238260835499673`*^9}, {3.5238267311383047`*^9, 
   3.5238267753303823`*^9}, {3.536524953386524*^9, 3.5365249537365446`*^9}, {
   3.536525184291732*^9, 3.536525280490234*^9}, {3.5365255811464305`*^9, 
   3.5365255819144745`*^9}, {3.5365256858704205`*^9, 3.536525699051174*^9}, {
   3.5365257299519415`*^9, 3.536525833296852*^9}, {3.5365260350733933`*^9, 
   3.536526052832409*^9}, {3.5365261628197002`*^9, 3.5365262066382065`*^9}, {
   3.536526248416596*^9, 3.536526259484229*^9}, {3.5365277998033304`*^9, 
   3.536528052830803*^9}, {3.536528105168796*^9, 3.5365281547736335`*^9}, {
   3.536528236903331*^9, 3.5365282587735815`*^9}, {3.536528349670781*^9, 
   3.5365284391258974`*^9}, 3.5365305509656878`*^9, {3.5365306090310087`*^9, 
   3.536530615589384*^9}, {3.536530686278427*^9, 3.536530699174165*^9}, {
   3.53653073440718*^9, 3.5365307906293955`*^9}, {3.536530907509081*^9, 
   3.536531022348649*^9}, {3.5365311160160065`*^9, 3.536531151095013*^9}, {
   3.536531181317742*^9, 3.5365311823097982`*^9}, {3.53653122341815*^9, 
   3.5365312578931217`*^9}, {3.5365313251469684`*^9, 
   3.5365313289001827`*^9}, {3.5365313630191345`*^9, 
   3.5365315273635345`*^9}, {3.5365319953473015`*^9, 
   3.5365319977624397`*^9}, {3.5365320444981127`*^9, 
   3.5365320706736097`*^9}, {3.536532148102039*^9, 3.5365321673001366`*^9}, {
   3.5365323719328413`*^9, 3.5365324241398273`*^9}, {3.5365327113502545`*^9, 
   3.5365327121663013`*^9}, {3.536532824351718*^9, 3.5365328336802516`*^9}, {
   3.5365329478497815`*^9, 3.53653294904885*^9}, {3.5365330891268625`*^9, 
   3.536533095047201*^9}, 3.5365334363907247`*^9, 3.5365335307301207`*^9, 
   3.5365338956069903`*^9, {3.5365416223119326`*^9, 3.536541740260679*^9}, {
   3.536541770918432*^9, 3.5365417915376115`*^9}, {3.5365418365891886`*^9, 
   3.536541851740055*^9}, {3.5365418962346*^9, 3.5365418998828087`*^9}, {
   3.536541997694403*^9, 3.536541998317439*^9}, 3.5365421084797397`*^9, {
   3.536596285260098*^9, 3.5365963176849527`*^9}, {3.5365963490587473`*^9, 
   3.536596355843135*^9}, {3.53659640889917*^9, 3.536596475221963*^9}, {
   3.5365968399798265`*^9, 3.5365968631531515`*^9}, {3.5365970408513155`*^9, 
   3.5365971046299634`*^9}, {3.5365972007424607`*^9, 3.53659736331876*^9}, {
   3.536597620346461*^9, 3.53659768904739*^9}, 3.5365977706620584`*^9, 
   3.5365978093342705`*^9, {3.5365978464263916`*^9, 3.5365978728399024`*^9}, 
   3.5365979033646483`*^9, {3.5365979361975265`*^9, 3.5365979416038356`*^9}, {
   3.5365979880554924`*^9, 3.5365980145660086`*^9}, 3.536598094550584*^9, {
   3.5365981560581017`*^9, 3.5365981710629597`*^9}, {3.536598383767126*^9, 
   3.5365984098336167`*^9}, 3.536598533547693*^9, 3.536609505575257*^9, 
   3.536610342408121*^9, 3.5366105935004826`*^9, 3.5366106273684196`*^9, 
   3.5366106630634613`*^9, {3.5366107542826786`*^9, 3.536610755047723*^9}, 
   3.5366108640369563`*^9, {3.536611012585453*^9, 3.536611026504249*^9}, {
   3.5366110682136345`*^9, 3.5366110687286644`*^9}, {3.5366111001194596`*^9, 
   3.536611126612975*^9}, {3.536773587647215*^9, 3.53677359928288*^9}, 
   3.5367737562918606`*^9, {3.536773951505026*^9, 3.5367740663405943`*^9}, {
   3.536774132721391*^9, 3.536774207235653*^9}},
 FontFamily->"Courier New",
 FontSize->18],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"center", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dists", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", "center"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"1", "n"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radius", "=", 
   RowBox[{"Max", "[", "dists", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", "center"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"1", "n"}], "+", "1"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "centers", " ", "all", " ", "control", " ", "points", " ", 
     "around", " ", "the", " ", "origin"}], ",", " ", 
    RowBox[{"for", " ", "easy", " ", "window", " ", "sizing"}]}], " ", "*)"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Black", " ", "polygon"}], " ", "&"}], " ", 
    RowBox[{"curve", ":", " ", 
     RowBox[{"original", ".", " ", 
      RowBox[{"Red", ":", " ", 
       RowBox[{"degree", " ", "reduced"}]}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curve", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"BezierCurve", "[", 
          RowBox[{"pt", ",", 
           RowBox[{"SplineDegree", "\[Rule]", " ", "n"}]}], "]"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"poly", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Line", "[", "pt", "]"}], "]"}]}], ";", 
     RowBox[{"bred", "=", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "elevmat", "]"}], ".", "elevmat"}], ",", 
        RowBox[{
         RowBox[{"Transpose", "[", "elevmat", "]"}], ".", "pt"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"redcurve", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Red", ",", 
         RowBox[{"BezierCurve", "[", 
          RowBox[{"bred", ",", 
           RowBox[{"SplineDegree", "\[Rule]", " ", 
            RowBox[{"n", "-", "1"}]}]}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"redpoly", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Red", ",", 
         RowBox[{"Line", "[", "bred", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"redpoints", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "Large", "]"}], ",", 
         RowBox[{"Point", "[", "bred", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "poly", ",", "redpoly", ",", "curve", ",", " ", "redcurve", ",", 
         "redpoints"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"1.2", "radius"}]}]}], "]"}]}], ")"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pt", ",", "b"}], "}"}], ",", "Locator"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.461364029671875*^9, 3.461364040625*^9}, {
   3.461364114859375*^9, 3.461364175671875*^9}, {3.4613642734375*^9, 
   3.461364275890625*^9}, {3.46136467590625*^9, 3.46136478290625*^9}, {
   3.46136484540625*^9, 3.4613649066875*^9}, {3.461365125671875*^9, 
   3.4613651834375*^9}, 3.461365224140625*^9, {3.46136526475*^9, 
   3.46136526696875*^9}, {3.461365372484375*^9, 3.46136541203125*^9}, 
   3.461365446578125*^9, {3.461365531171875*^9, 3.461365540375*^9}, {
   3.461365622859375*^9, 3.461365752296875*^9}, {3.461365797734375*^9, 
   3.461365801875*^9}, {3.523824951128378*^9, 3.5238249746844196`*^9}, {
   3.5238251492955265`*^9, 3.523825155691538*^9}, {3.523825380175932*^9, 
   3.523825423247607*^9}, {3.5365315850718355`*^9, 3.5365316093582244`*^9}, {
   3.5365324412768073`*^9, 3.5365325503550463`*^9}, {3.5365326431393533`*^9, 
   3.5365326441314096`*^9}, 3.536532697424458*^9, {3.5365327347075906`*^9, 
   3.5365327592339935`*^9}, {3.53659689004869*^9, 3.5365969033434505`*^9}, {
   3.53659695036614*^9, 3.536597014830827*^9}, 3.536597666458098*^9, {
   3.5365977071134233`*^9, 3.536597745294607*^9}, {3.53659812578837*^9, 
   3.536598139051129*^9}, {3.5365981732570853`*^9, 3.5365981775773325`*^9}, {
   3.5366091131118093`*^9, 3.536609162834653*^9}, {3.536609193267394*^9, 
   3.5366091942904525`*^9}, {3.5366092276323595`*^9, 
   3.5366092502796545`*^9}, {3.5366094339931626`*^9, 
   3.5366094774536486`*^9}, {3.536609622742958*^9, 3.536609637525804*^9}, {
   3.536609706133728*^9, 3.5366097066767592`*^9}, {3.5366097740316114`*^9, 
   3.5366097913096*^9}, {3.5366098251145334`*^9, 3.5366098511620235`*^9}, {
   3.5366099434773035`*^9, 3.5366099446923733`*^9}, {3.53660999709337*^9, 
   3.5366100001985474`*^9}, {3.536610300009696*^9, 3.5366103053540015`*^9}, {
   3.5366103852655725`*^9, 3.5366103888807793`*^9}, {3.5366104822621202`*^9, 
   3.5366104899095573`*^9}, {3.536610741977975*^9, 3.5366107615090923`*^9}, 
   3.536610840727623*^9, {3.53661340217913*^9, 3.536613437297138*^9}, {
   3.5367738697403493`*^9, 3.5367739159409924`*^9}},
 FontFamily->"Courier New",
 FontSize->18],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pt$$ = {{-1, 
      Rational[-1, 2]}, {0, 
      Rational[1, 2]}, {0, 
      Rational[1, 2]}, {1, 
      Rational[-1, 2]}}, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pt$$], {{-1, 
         Rational[-1, 2]}, {0, 
         Rational[1, 2]}, {0, 
         Rational[1, 2]}, {1, 
         Rational[-1, 2]}}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`pt$$ = {{-1, 
           Rational[-1, 2]}, {0, 
           Rational[1, 2]}, {0, 
           Rational[1, 2]}, {1, 
           Rational[-1, 2]}}}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`curve = Graphics[{Thick, 
           
           BezierCurve[$CellContext`pt$$, 
            SplineDegree -> $CellContext`n]}]; $CellContext`poly = Graphics[
          Line[$CellContext`pt$$]]; $CellContext`bred = LinearSolve[
          Dot[
           Transpose[$CellContext`elevmat], $CellContext`elevmat], 
          Dot[
           
           Transpose[$CellContext`elevmat], $CellContext`pt$$]]; \
$CellContext`redcurve = Graphics[{Thick, Red, 
           
           BezierCurve[$CellContext`bred, 
            SplineDegree -> $CellContext`n - 1]}]; $CellContext`redpoly = 
        Graphics[{Thick, Red, 
           Line[$CellContext`bred]}]; $CellContext`redpoints = Graphics[{
           PointSize[Large], 
           Point[$CellContext`bred]}]; 
       Show[{$CellContext`poly, $CellContext`redpoly, $CellContext`curve, \
$CellContext`redcurve, $CellContext`redpoints}, PlotRange -> 
         1.2 $CellContext`radius]), 
      "Specifications" :> {{{$CellContext`pt$$, {{-1, 
            Rational[-1, 2]}, {0, 
            Rational[1, 2]}, {0, 
            Rational[1, 2]}, {1, 
            Rational[-1, 2]}}}, Automatic, ControlType -> Locator}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{417., {212., 217.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6018570215416436`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1191, 647},
WindowMargins->{{76, Automatic}, {42, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 229, 6, 91, "Subtitle"],
Cell[799, 30, 909, 17, 107, "Text"],
Cell[1711, 49, 11116, 232, 631, "Input"],
Cell[CellGroupData[{
Cell[12852, 285, 6066, 148, 442, "Input"],
Cell[18921, 435, 2873, 65, 446, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
